

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% SAT PRESSURE FROM TEMPERATURE %%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
function psat=SatPressure(ta)
 U=1; %U=1 metodo 13788 U=2 metodo ashrae
switch (U)
case 1
 if ta>0
    psat=610.5*exp(17.269*ta/(237.3+ta));
  else
    psat=610.5*exp(21.875*ta/(265.5+ta));
  endif
case 2
T = ta + 273.15;
if ta < 0 
    C1 = -5674.5359;
    c2 = 6.3925247;
    c3 = -0.009677843;
    c4 = 0.00000062215701;
    c5 = 2.0747825E-09;
    c6 = -9.484024E-13;
    c7 = 4.1635019;
else
    C1 = -5800.2206;
    c2 = 1.3914993;
    c3 = -0.048640239;
    c4 = 0.000041764768;
    c5 = -0.000000014452093;
    c6 = 0;
    c7 = 6.5459673;
endif

lnpws = C1 / T + c2 + c3 * T + c4 * T ^ 2 + c5 * T ^ 3 + c6 * T ^ 4 + c7 * log(T);
psat = exp(lnpws);
endswitch
endfunction

